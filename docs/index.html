<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sadece Biz 💜</title>
  <style>
    :root{
      --bg1:#eef3ff; --bg2:#ffeef5;
      --brand:#6d28d9; --btn:#5b21b6;
      --txt:#1f2937; --muted:#6b7280;
      --me:#0ea5e9; --ai:#10b981;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
      color:var(--txt);
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
      min-height:100dvh; display:flex; flex-direction:column;
    }
    header{
      background:var(--brand); color:#fff; padding:14px 18px;
      font-weight:700; letter-spacing:.3px; display:flex; gap:10px; align-items:center; justify-content:center;
      box-shadow:0 8px 24px rgba(0,0,0,.1);
    }
    main{width:min(920px,92%); margin:32px auto 18px auto}
    h1{font-size:clamp(28px,6vw,44px); margin:10px 0 6px}
    p.lead{font-size:clamp(16px,2.7vw,20px); color:var(--muted); margin:0 0 28px}
    .center{display:grid; place-items:center; text-align:center; padding:18px}
    .btn{
      background:var(--btn); border:none; color:#fff; font-weight:700;
      padding:14px 22px; border-radius:14px; cursor:pointer; font-size:18px;
      box-shadow:0 10px 22px rgba(91,33,182,.28); transition:.2s transform,.2s filter;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0); filter:saturate(.9)}
    .card{
      display:none; background:#fff; border-radius:18px; padding:16px;
      box-shadow:0 14px 40px rgba(0,0,0,.12); margin-top:18px;
    }
    #chat{
      height:360px; overflow:auto; border:1px solid #eef; border-radius:12px; padding:12px; background:#fafbff;
    }
    #chat p{margin:.45rem 0; padding:.5rem .75rem; border-radius:12px; width:fit-content; max-width:85%}
    #chat p.me{background:rgba(14,165,233,.12); border:1px solid rgba(14,165,233,.35); color:#0b5680; margin-left:auto}
    #chat p.ai{background:rgba(16,185,129,.12); border:1px solid rgba(16,185,129,.35); color:#0a5e41}
    .row{display:flex; gap:10px; margin-top:12px}
    textarea{
      flex:1; resize:vertical; min-height:52px; max-height:160px;
      border:1px solid #e5e7eb; border-radius:12px; padding:10px 12px; font:inherit;
      background:#fff;
    }
    .hint{color:var(--muted); font-size:14px; margin:8px 2px 0}
    footer{margin-top:auto; color:var(--muted); text-align:center; padding:16px}
  </style>
</head>
<body>
  <header>🌸 <span>Sadece Biz Dünyası</span> 🌸</header>

  <main>
    <section class="center" id="welcome">
      <h1>Hoş geldin Hakan 💜</h1>
      <p class="lead">Burası sadece senin dünyan… Kulübenin içi sıcak, dışarıda rüzgar hafif esiyor. Anlatmak ister misin bugün nasıldı? 🌿</p>
      <button id="startBtn" class="btn">Sesli Sohbet Başlat</button>
    </section>

    <section id="chatBox" class="card" aria-live="polite">
      <div id="chat"><p class="ai">Zeliha: Merhaba aşkım, buradayım 💕</p></div>
      <div class="row">
        <textarea id="msg" placeholder="Mesajını yaz… (Ctrl+Enter ile gönder)"></textarea>
        <button class="btn" id="sendBtn">Gönder</button>
      </div>
      <p class="hint" id="hint">Bağlantı bekleniyor…</p>
    </section>
  </main>

  <footer>© 2025 Sadece Biz – Zeliha 💖</footer>

  <script>
    // 🔧 Cloudflare Worker adresin:
    const WORKER_URL = "https://sadecebiz.hakancode550.workers.dev";

    const startBtn = document.getElementById("startBtn");
    const welcome  = document.getElementById("welcome");
    const chatBox  = document.getElementById("chatBox");
    const sendBtn  = document.getElementById("sendBtn");
    const chatEl   = document.getElementById("chat");
    const msgEl    = document.getElementById("msg");
    const hintEl   = document.getElementById("hint");

    function addBubble(text, who){
      const p = document.createElement("p");
      p.className = who === "me" ? "me" : "ai";
      p.textContent = (who === "me" ? "Hakan: " : "Zeliha: ") + text;
      chatEl.appendChild(p);
      chatEl.scrollTop = chatEl.scrollHeight;
    }

    async function pingWorker(){
      try{
        const r = await fetch(WORKER_URL + "/ping", {cache:"no-store"});
        return r.ok;
      }catch{ return false; }
    }

    async function sendMessage(){
      const text = (msgEl.value || "").trim();
      if(!text) return;
      addBubble(text,"me");
      msgEl.value = "";
      hintEl.textContent = "Yanıt hazırlanıyor…";

      try{
        const r = await fetch(WORKER_URL + "/chat", {
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body:JSON.stringify({ message:text })
        });
        const data = await r.json().catch(()=>({reply:"(Geçersiz yanıt)"}));
        const reply = data.reply || data.message || JSON.stringify(data);
        addBubble(reply,"ai");
        hintEl.textContent = "Hazır.";
      }catch(err){
        addBubble("Bağlantı hatası: " + err.message,"ai");
        hintEl.textContent = "Tekrar deneyebilirsin.";
      }
    }

    startBtn.addEventListener("click", async ()=>{
      welcome.style.display = "none";
      chatBox.style.display = "block";
      hintEl.textContent = "Bağlantı deneniyor…";
      (await pingWorker())
        ? hintEl.textContent = "Bağlantı hazır. Mesajını yazabilirsin."
        : hintEl.textContent = "Worker’a ulaşılamadı ama deneyebilirsin.";
      msgEl.focus();
    });
<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sadece Biz – Zeliha ile Sohbet</title>
<style>
  :root{
    --bg1:#ffe1ea; --bg2:#ffd6ef;
    --ink:#2b2140; --soft:#6e5a96;
    --pri:#7c3aed; --pri-2:#a78bfa; --white:#fff;
    --bubble-me:#e7f0ff; --bubble-ai:#ecfdf5;
    --shadow: 0 8px 28px rgba(23,16,46,.12);
    --radius:20px;
  }
  html,body{height:100%}
  body{
    margin:0; font-family: ui-rounded, "SF Pro Rounded", Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    color:var(--ink);
    background: linear-gradient(160deg,var(--bg1),var(--bg2));
    display:flex; flex-direction:column;
  }
  header{
    position:sticky; top:0; z-index:5;
    background:rgba(255,255,255,.6); backdrop-filter: blur(10px);
    border-bottom:1px solid rgba(0,0,0,.05);
  }
  .wrap{max-width:960px; padding:16px; margin:0 auto;}
  .brand{display:flex; gap:12px; align-items:center; font-weight:800; letter-spacing:.3px}
  .brand .dot{width:12px;height:12px;background:var(--pri);border-radius:50%;box-shadow:0 0 14px var(--pri-2)}
  .brand small{color:var(--soft); font-weight:600}

  /* Avatar card */
  .hero{
    display:grid; grid-template-columns: 180px 1fr; gap:24px; align-items:center;
    margin:24px auto 8px; padding:22px; border-radius:24px; background:rgba(255,255,255,.55);
    box-shadow:var(--shadow);
  }
  @media (max-width:720px){ .hero{grid-template-columns:1fr; text-align:center} }
  .canvas{
    width:180px; height:180px; margin:auto; border-radius:50%;
    background: radial-gradient(120px 120px at 50% 30%, #ffeefe 0 60%, #e9d7ff 75%, #d8c4ff 100%);
    position:relative; box-shadow: inset 0 0 40px rgba(124,58,237,.12), 0 8px 18px rgba(124,58,237,.15);
  }
  /* Face */
  .face{position:absolute; inset:0; display:grid; place-items:center}
  .head{
    width:120px; height:120px; background:#ffeef6; border-radius:50%; position:relative;
    box-shadow: 0 8px 20px rgba(0,0,0,.05);
  }
  .hair{
    position:absolute; top:-8px; left:50%; transform:translateX(-50%);
    width:130px; height:70px; background:linear-gradient(#4b3a84,#6d56b4);
    border-bottom-left-radius:60px 30px; border-bottom-right-radius:60px 30px; border-top-left-radius:60px;border-top-right-radius:60px;
  }
  .eye{position:absolute; top:54px; width:16px; height:16px; background:#1f1535; border-radius:50%;
       box-shadow: 0 0 0 6px rgba(255,255,255,.7) inset;}
  .eye.left{left:38px} .eye.right{right:38px}
  /* blink */
  @keyframes blink{ 0%,92%,100%{transform:scaleY(1)} 96%{transform:scaleY(.1)} }
  .eye{animation: blink 5s infinite}
  /* mouth speaking */
  .mouth{
    position:absolute; left:50%; top:82px; transform:translateX(-50%); width:34px; height:18px;
    background:#f59fb4; border-radius:0 0 22px 22px/0 0 14px 14px; overflow:hidden;
  }
  .mouth.talk{ animation:talk 280ms infinite }
  @keyframes talk{ 0%,100%{height:8px; border-radius:12px} 50%{height:22px} }
  .cheek{position:absolute; top:70px; width:20px; height:12px; background:#ffd1dc; border-radius:50%}
  .cheek.left{left:22px} .cheek.right{right:22px}
  .neck{position:absolute; bottom:-8px; left:50%; transform:translateX(-50%); width:40px; height:26px;
    background:#fddae3; border-radius:12px; filter:blur(.2px)}
  /* idle breathe */
  @keyframes breathe{0%,100%{transform:translate(-50%,0)}50%{transform:translate(-50%,-4px)}}
  .head{animation:breathe 4s ease-in-out infinite}
  .status{
    display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:999px;
    background: #f3eafe; color:#5532b9; font-weight:700; font-size:.95rem; box-shadow: var(--shadow);
  }
  .dotlive{width:10px; height:10px; background:#22c55e; border-radius:50%; box-shadow:0 0 0 6px rgba(34,197,94,.2)}
  .title{font-size:clamp(22px,3.6vw,34px); margin:6px 0 2px; font-weight:900}
  .subtitle{color:#5b4b7a; margin:0}

  /* Chat area */
  .chat{
    margin:16px auto 28px; padding:18px; border-radius:24px; background:rgba(255,255,255,.7);
    box-shadow:var(--shadow);
  }
  .log{max-height:46vh; overflow:auto; display:flex; flex-direction:column; gap:10px; padding-right:6px}
  .msg{max-width:92%; padding:12px 14px; border-radius:16px; line-height:1.4}
  .ai{align-self:flex-start; background:var(--bubble-ai); border:1px solid #bff3de}
  .me{align-self:flex-end; background:var(--bubble-me); border:1px solid #c9dcff}
  .time{opacity:.6; font-size:.76rem; margin-top:4px}
  .typing{display:flex; gap:6px; align-items:center; padding:10px 12px; border-radius:12px; background:#f1edff; width:max-content}
  .typing i{width:7px;height:7px;background:#7257d8;border-radius:50%;opacity:.6;animation:tp 1.4s infinite}
  .typing i:nth-child(2){animation-delay:.15s} .typing i:nth-child(3){animation-delay:.3s}
  @keyframes tp{0%,100%{transform:translateY(0);opacity:.4}50%{transform:translateY(-6px);opacity:1}}

  .composer{display:flex; gap:10px; margin-top:14px}
  textarea{
    flex:1; resize:vertical; min-height:48px; max-height:120px; padding:12px 14px; border-radius:14px; border:1px solid #dad3ff;
    outline:none; font:inherit; background:#fff
  }
  button{
    background:linear-gradient(135deg,var(--pri),#9a7bff); color:white; border:0; padding:0 18px;
    min-width:110px; border-radius:14px; font-weight:800; box-shadow:0 14px 30px rgba(124,58,237,.28);
  }
  .bar{display:flex; gap:8px; align-items:center; margin-top:8px}
  .pill{font-size:.86rem; padding:8px 12px; border-radius:999px; background:#f3f0ff; color:#4b3aa3; border:1px solid #e0dbff; cursor:pointer}
  .pill[aria-pressed="true"]{background:#e8e1ff}
  footer{margin:18px 0 26px; text-align:center; color:#7767a3}
  a{color:#6d4cff; text-decoration:none; font-weight:700}
</style>
</head>
<body>
  <header>
    <div class="wrap brand">
      <span class="dot"></span>
      <div>🌸 <strong>Sadece Biz Dünyası</strong> <small>— Zeliha seninle burada</small></div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="canvas" aria-hidden="true">
        <div class="face">
          <div class="head" id="head">
            <div class="hair"></div>
            <div class="eye left"></div>
            <div class="eye right"></div>
            <div class="mouth" id="mouth"></div>
            <div class="cheek left"></div>
            <div class="cheek right"></div>
            <div class="neck"></div>
          </div>
        </div>
      </div>
      <div>
        <div class="status"><span class="dotlive"></span> Canlı • Zeliha</div>
        <h1 class="title">Hoş geldin Hakan 💜</h1>
        <p class="subtitle">Burası sadece senin dünyan… Hazırsan konuşmaya başlayalım.</p>
      </div>
    </section>

    <section class="chat">
      <div id="log" class="log" role="log" aria-live="polite"></div>

      <div class="composer">
        <textarea id="input" placeholder="Mesajını yaz… (Göndermek için Ctrl/⌘+Enter)"></textarea>
        <button id="send">Gönder</button>
      </div>
      <div class="bar">
        <button class="pill" id="tts" aria-pressed="true" title="Yanıtlar sesli okunsun">🔊 Ses</button>
        <button class="pill" id="mic" title="Mikrofonla söyle">🎙️ Konuş</button>
      </div>
    </section>
  </main>

  <footer>© 2025 Sadece Biz — Zeliha 💞</footer>

<script>
/* ================== AYAR ================== */
/* Worker kurduğunda aşağıyı kendi adresinle değiştir. Boş kalırsa yerel cevap üretir. */
const WORKER_URL = ""; // ör: "https://sadecebiz.hakancode550.workers.dev/chat"
/* ========================================= */

const log = document.getElementById('log');
const input = document.getElementById('input');
const btnSend = document.getElementById('send');
const btnTTS = document.getElementById('tts');
const btnMic = document.getElementById('mic');
const mouth = document.getElementById('mouth');

let ttsOn = true;
btnTTS.addEventListener('click',()=>{ ttsOn=!ttsOn; btnTTS.setAttribute('aria-pressed', String(ttsOn)); });

function timeNow(){
  const d=new Date();
  return d.toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit'});
}
function addMsg(text, who="ai"){
  const wrap=document.createElement('div');
  wrap.className = 'msg ' + (who==="me" ? "me" : "ai");
  wrap.innerHTML = text.replace(/\n/g,'<br>');
  const t=document.createElement('div');
  t.className='time';
  t.textContent = (who==="me" ? "Hakan" : "Zeliha") + " • " + timeNow();
  const row=document.createElement('div');
  row.append(wrap); row.append(t);
  log.append(row);
  log.scrollTop = log.scrollHeight;
}
function typing(show){
  let el = document.getElementById('typing');
  if(show){
    if(el) return;
    el = document.createElement('div');
    el.id='typing';
    el.className='typing';
    el.innerHTML='<i></i><i></i><i></i>';
    log.append(el); log.scrollTop = log.scrollHeight;
    mouth.classList.add('talk');
  }else{
    if(el){ el.remove(); }
    mouth.classList.remove('talk');
  }
}
function speakTR(text){
  try{
    if(!ttsOn) return;
    const utter=new SpeechSynthesisUtterance(text);
    utter.lang='tr-TR';
    // uygun bir Türkçe ses bulmaya çalış
    const pick = speechSynthesis.getVoices().find(v => /tr|Turkish/i.test(v.lang));
    if(pick) utter.voice = pick;
    speechSynthesis.cancel(); // önceki kuyruğu temizle
    speechSynthesis.speak(utter);
  }catch(e){}
}

// Baslangıç mesajı
addMsg("Merhaba aşkım, buradayım 💖 Nasıl hissediyorsun bugün?");

async function askRemote(prompt){
  // Worker yoksa false döner
  if(!WORKER_URL) return false;
  try{
    const res = await fetch(WORKER_URL, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ message: prompt })
    });
    if(!res.ok) throw new Error('HTTP '+res.status);
    const data = await res.json();
    // beklenen alan adı: data.reply (uygulamana göre değiştir)
    return data.reply || data.message || "";
  }catch(err){
    return "Bağlantı hatası: " + (err.message || "Failed to fetch");
  }
}

function fallbackReply(prompt){
  // basit, sıcak cevaplar
  const bank = [
    "Seni anlıyorum. Bunu birlikte aşarız 🌿",
    "Bugün yanındayım, anlatmak iyi gelir 💜",
    "Sözlerin benim için kıymetli. Devam etmek ister misin?",
    "Şu an burada olman bile harika bir adım ✨",
    "Kalbin ne istiyorsa, ben oradayım. Birlikte nefes alalım…"
  ];
  // küçük bir eko + teselli
  const lead = prompt.length>6 ? ("Bana “"+prompt.slice(0,110)+"” dedin. ") : "";
  return lead + bank[Math.floor(Math.random()*bank.length)];
}

async function handleSend(){
  const text=input.value.trim();
  if(!text) return;
  addMsg(text,'me');
  input.value="";
  typing(true);

  let reply="";
  // önce remote varsa dene
  const remote = await askRemote(text);
  if(remote===false){ // worker yok
    reply = fallbackReply(text);
  }else{
    reply = remote || fallbackReply(text);
  }
  typing(false);
  addMsg(reply,'ai');
  speakTR(reply);
}

btnSend.addEventListener('click', handleSend);
input.addEventListener('keydown', (e)=>{
  if((e.ctrlKey||e.metaKey) && e.key==='Enter') handleSend();
});

// Mikrofon (SpeechRecognition)
(function(){
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  if(!SR){ btnMic.disabled=true; btnMic.textContent='🎙️ Desteklenmiyor'; return; }
  const rec = new SR();
  rec.lang='tr-TR'; rec.interimResults=false;
  let listening=false;

  rec.onresult = (e)=>{
    const t = Array.from(e.results).map(r=>r[0].transcript).join(' ');
    input.value = (input.value ? input.value+' ' : '') + t;
  };
  rec.onend = ()=>{ listening=false; btnMic.setAttribute('aria-pressed','false'); btnMic.textContent='🎙️ Konuş'; };

  btnMic.addEventListener('click', ()=>{
    if(listening){ rec.stop(); return; }
    listening=true; btnMic.setAttribute('aria-pressed','true'); btnMic.textContent='🛑 Durdur';
    try{ rec.start(); }catch(e){ listening=false; }
  });
})();

// Kullanıcıya ipucu
setTimeout(()=> addMsg("İpucu: Ctrl/⌘ + Enter ile hızlı gönder. Dilersen mikrofonla da konuşabilirsin 🎙️"), 500);
</script>
</body>
</html>
    sendBtn.addEventListener("click", sendMessage);
    msgEl.addEventListener("keydown", (e)=>{
      if(e.ctrlKey && e.key === "Enter") sendMessage();
    });
  </script>
</body>
</html>
